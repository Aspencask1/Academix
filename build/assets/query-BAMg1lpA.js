var t,e,s,i,n,r,a,o,h,l,u,c,d,p,f,y,v,m,b,g,w,O,M,k,P,S,F,C,q,W,R,A,E,U,D,Q,K,x,T,j,L,I,G,H,_,B,N,z,$,J,V,X,Y,Z,tt,et,st,it,nt,rt,at,ot,ht,lt,ut,ct,dt,pt,ft,yt,vt,mt,bt,gt,wt,Ot,Mt,kt=Object.defineProperty,Pt=Object.defineProperties,St=Object.getOwnPropertyDescriptors,Ft=Object.getOwnPropertySymbols,Ct=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable,Wt=t=>{throw TypeError(t)},Rt=Math.pow,At=(t,e,s)=>e in t?kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,Et=(t,e)=>{for(var s in e||(e={}))Ct.call(e,s)&&At(t,s,e[s]);if(Ft)for(var s of Ft(e))qt.call(e,s)&&At(t,s,e[s]);return t},Ut=(t,e)=>Pt(t,St(e)),Dt=(t,e,s)=>e.has(t)||Wt("Cannot "+s),Qt=(t,e,s)=>(Dt(t,e,"read from private field"),s?s.call(t):e.get(t)),Kt=(t,e,s)=>e.has(t)?Wt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),xt=(t,e,s,i)=>(Dt(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),Tt=(t,e,s)=>(Dt(t,e,"access private method"),s),jt=(t,e,s,i)=>({set _(i){xt(t,e,i,s)},get _(){return Qt(t,e,i)}}),Lt=(t,e,s)=>new Promise((i,n)=>{var r=t=>{try{o(s.next(t))}catch(e){n(e)}},a=t=>{try{o(s.throw(t))}catch(e){n(e)}},o=t=>t.done?i(t.value):Promise.resolve(t.value).then(r,a);o((s=s.apply(t,e)).next())}),It=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Gt="undefined"==typeof window||"Deno"in window;function Ht(){}function _t(t){return"number"==typeof t&&t>=0&&t!==1/0}function Bt(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Nt(t,e){const{type:s="all",exact:i,fetchStatus:n,predicate:r,queryKey:a,stale:o}=t;if(a)if(i){if(e.queryHash!==$t(a,e.options))return!1}else if(!Vt(e.queryKey,a))return!1;if("all"!==s){const t=e.isActive();if("active"===s&&!t)return!1;if("inactive"===s&&t)return!1}return("boolean"!=typeof o||e.isStale()===o)&&((void 0===n||n===e.state.fetchStatus)&&!(r&&!r(e)))}function zt(t,e){const{exact:s,status:i,predicate:n,mutationKey:r}=t;if(r){if(!e.options.mutationKey)return!1;if(s){if(Jt(e.options.mutationKey)!==Jt(r))return!1}else if(!Vt(e.options.mutationKey,r))return!1}return(!i||e.state.status===i)&&!(n&&!n(e))}function $t(t,e){return((null==e?void 0:e.queryKeyHashFn)||Jt)(t)}function Jt(t){return JSON.stringify(t,(t,e)=>te(e)?Object.keys(e).sort().reduce((t,s)=>(t[s]=e[s],t),{}):e)}function Vt(t,e){return t===e||typeof t==typeof e&&(!(!t||!e||"object"!=typeof t||"object"!=typeof e)&&!Object.keys(e).some(s=>!Vt(t[s],e[s])))}function Xt(t,e){if(t===e)return t;const s=Zt(t)&&Zt(e);if(s||te(t)&&te(e)){const i=s?t.length:Object.keys(t).length,n=s?e:Object.keys(e),r=n.length,a=s?[]:{};let o=0;for(let h=0;h<r;h++){const i=s?h:n[h];a[i]=Xt(t[i],e[i]),a[i]===t[i]&&o++}return i===r&&o===i?t:a}return e}function Yt(t,e){if(t&&!e||e&&!t)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}function Zt(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function te(t){if(!ee(t))return!1;const e=t.constructor;if(void 0===e)return!0;const s=e.prototype;return!!ee(s)&&!!s.hasOwnProperty("isPrototypeOf")}function ee(t){return"[object Object]"===Object.prototype.toString.call(t)}function se(t,e,s){return"function"==typeof s.structuralSharing?s.structuralSharing(t,e):!1!==s.structuralSharing?Xt(t,e):e}function ie(t,e,s=0){const i=[...t,e];return s&&i.length>s?i.slice(1):i}function ne(t,e,s=0){const i=[e,...t];return s&&i.length>s?i.slice(0,-1):i}var re=new(i=class extends It{constructor(){super(),Kt(this,t),Kt(this,e),Kt(this,s),xt(this,s,t=>{if(!Gt&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}})}onSubscribe(){Qt(this,e)||this.setEventListener(Qt(this,s))}onUnsubscribe(){var t;this.hasListeners()||(null==(t=Qt(this,e))||t.call(this),xt(this,e,void 0))}setEventListener(t){var i;xt(this,s,t),null==(i=Qt(this,e))||i.call(this),xt(this,e,t(t=>{"boolean"==typeof t?this.setFocused(t):this.onFocus()}))}setFocused(e){Qt(this,t)!==e&&(xt(this,t,e),this.onFocus())}onFocus(){this.listeners.forEach(t=>{t()})}isFocused(){var e;return"boolean"==typeof Qt(this,t)?Qt(this,t):"hidden"!==(null==(e=globalThis.document)?void 0:e.visibilityState)}},t=new WeakMap,e=new WeakMap,s=new WeakMap,i),ae=new(o=class extends It{constructor(){super(),Kt(this,n,!0),Kt(this,r),Kt(this,a),xt(this,a,t=>{if(!Gt&&window.addEventListener){const e=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}})}onSubscribe(){Qt(this,r)||this.setEventListener(Qt(this,a))}onUnsubscribe(){var t;this.hasListeners()||(null==(t=Qt(this,r))||t.call(this),xt(this,r,void 0))}setEventListener(t){var e;xt(this,a,t),null==(e=Qt(this,r))||e.call(this),xt(this,r,t(this.setOnline.bind(this)))}setOnline(t){Qt(this,n)!==t&&(xt(this,n,t),this.listeners.forEach(e=>{e(t)}))}isOnline(){return Qt(this,n)}},n=new WeakMap,r=new WeakMap,a=new WeakMap,o);function oe(t){return Math.min(1e3*Rt(2,t),3e4)}function he(t){return"online"!==(null!=t?t:"online")||ae.isOnline()}var le=class{constructor(t){this.revert=null==t?void 0:t.revert,this.silent=null==t?void 0:t.silent}};function ue(t){return t instanceof le}function ce(t){let e,s,i,n=!1,r=0,a=!1;const o=new Promise((t,e)=>{s=t,i=e}),h=()=>!re.isFocused()||"always"!==t.networkMode&&!ae.isOnline(),l=i=>{var n;a||(a=!0,null==(n=t.onSuccess)||n.call(t,i),null==e||e(),s(i))},u=s=>{var n;a||(a=!0,null==(n=t.onError)||n.call(t,s),null==e||e(),i(s))},c=()=>new Promise(s=>{var i;e=t=>{const e=a||!h();return e&&s(t),e},null==(i=t.onPause)||i.call(t)}).then(()=>{var s;e=void 0,a||null==(s=t.onContinue)||s.call(t)}),d=()=>{if(a)return;let e;try{e=t.fn()}catch(s){e=Promise.reject(s)}Promise.resolve(e).then(l).catch(e=>{var s,i,o;if(a)return;const l=null!=(s=t.retry)?s:Gt?0:3,p=null!=(i=t.retryDelay)?i:oe,f="function"==typeof p?p(r,e):p,y=!0===l||"number"==typeof l&&r<l||"function"==typeof l&&l(r,e);var v;!n&&y?(r++,null==(o=t.onFail)||o.call(t,r,e),(v=f,new Promise(t=>{setTimeout(t,v)})).then(()=>{if(h())return c()}).then(()=>{n?u(e):d()})):u(e)})};return he(t.networkMode)?d():c().then(d),{promise:o,cancel:e=>{var s;a||(u(new le(e)),null==(s=t.abort)||s.call(t))},continue:()=>(null==e?void 0:e())?o:Promise.resolve(),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1}}}var de=function(){let t=[],e=0,s=t=>{t()},i=t=>{t()},n=t=>setTimeout(t,0);const r=i=>{e?t.push(i):n(()=>{s(i)})},a=()=>{const e=t;t=[],e.length&&n(()=>{i(()=>{e.forEach(t=>{s(t)})})})};return{batch:t=>{let s;e++;try{s=t()}finally{e--,e||a()}return s},batchCalls:t=>(...e)=>{r(()=>{t(...e)})},schedule:r,setNotifyFunction:t=>{s=t},setBatchNotifyFunction:t=>{i=t},setScheduler:t=>{n=t}}}(),pe=(l=class{constructor(){Kt(this,h)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_t(this.gcTime)&&xt(this,h,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,null!=t?t:Gt?1/0:3e5)}clearGcTimeout(){Qt(this,h)&&(clearTimeout(Qt(this,h)),xt(this,h,void 0))}},h=new WeakMap,l),fe=(O=class extends pe{constructor(t){super(),Kt(this,b),Kt(this,u),Kt(this,c),Kt(this,d),Kt(this,p),Kt(this,f),Kt(this,y),Kt(this,v),Kt(this,m),xt(this,m,!1),xt(this,v,t.defaultOptions),Tt(this,b,g).call(this,t.options),xt(this,y,[]),xt(this,d,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,xt(this,u,t.state||function(t){const e="function"==typeof t.initialData?t.initialData():t.initialData,s=void 0!==e,i=s?"function"==typeof t.initialDataUpdatedAt?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?null!=i?i:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}(this.options)),this.state=Qt(this,u),this.scheduleGc()}get meta(){return this.options.meta}optionalRemove(){Qt(this,y).length||"idle"!==this.state.fetchStatus||Qt(this,d).remove(this)}setData(t,e){const s=se(this.state.data,t,this.options);return Tt(this,b,w).call(this,{data:s,type:"success",dataUpdatedAt:null==e?void 0:e.updatedAt,manual:null==e?void 0:e.manual}),s}setState(t,e){Tt(this,b,w).call(this,{type:"setState",state:t,setStateOptions:e})}cancel(t){var e;const s=Qt(this,p);return null==(e=Qt(this,f))||e.cancel(t),s?s.then(Ht).catch(Ht):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Qt(this,u))}isActive(){return Qt(this,y).some(t=>!1!==t.options.enabled)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||Qt(this,y).some(t=>t.getCurrentResult().isStale)}isStaleByTime(t=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!Bt(this.state.dataUpdatedAt,t)}onFocus(){var t;const e=Qt(this,y).find(t=>t.shouldFetchOnWindowFocus());null==e||e.refetch({cancelRefetch:!1}),null==(t=Qt(this,f))||t.continue()}onOnline(){var t;const e=Qt(this,y).find(t=>t.shouldFetchOnReconnect());null==e||e.refetch({cancelRefetch:!1}),null==(t=Qt(this,f))||t.continue()}addObserver(t){Qt(this,y).includes(t)||(Qt(this,y).push(t),this.clearGcTimeout(),Qt(this,d).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){Qt(this,y).includes(t)&&(xt(this,y,Qt(this,y).filter(e=>e!==t)),Qt(this,y).length||(Qt(this,f)&&(Qt(this,m)?Qt(this,f).cancel({revert:!0}):Qt(this,f).cancelRetry()),this.scheduleGc()),Qt(this,d).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return Qt(this,y).length}invalidate(){this.state.isInvalidated||Tt(this,b,w).call(this,{type:"invalidate"})}fetch(t,e){var s,i,n,r;if("idle"!==this.state.fetchStatus)if(this.state.dataUpdatedAt&&(null==e?void 0:e.cancelRefetch))this.cancel({silent:!0});else if(Qt(this,p))return null==(s=Qt(this,f))||s.continueRetry(),Qt(this,p);if(t&&Tt(this,b,g).call(this,t),!this.options.queryFn){const t=Qt(this,y).find(t=>t.options.queryFn);t&&Tt(this,b,g).call(this,t.options)}const a=new AbortController,o={queryKey:this.queryKey,meta:this.meta},h=t=>{Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(xt(this,m,!0),a.signal)})};h(o);const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:()=>this.options.queryFn?(xt(this,m,!1),this.options.persister?this.options.persister(this.options.queryFn,o,this):this.options.queryFn(o)):Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`))};h(l),null==(i=this.options.behavior)||i.onFetch(l,this),xt(this,c,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===(null==(n=l.fetchOptions)?void 0:n.meta)||Tt(this,b,w).call(this,{type:"fetch",meta:null==(r=l.fetchOptions)?void 0:r.meta});const u=t=>{var e,s,i,n;ue(t)&&t.silent||Tt(this,b,w).call(this,{type:"error",error:t}),ue(t)||(null==(s=(e=Qt(this,d).config).onError)||s.call(e,t,this),null==(n=(i=Qt(this,d).config).onSettled)||n.call(i,this.state.data,t,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return xt(this,f,ce({fn:l.fetchFn,abort:a.abort.bind(a),onSuccess:t=>{var e,s,i,n;void 0!==t?(this.setData(t),null==(s=(e=Qt(this,d).config).onSuccess)||s.call(e,t,this),null==(n=(i=Qt(this,d).config).onSettled)||n.call(i,t,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1):u(new Error(`${this.queryHash} data is undefined`))},onError:u,onFail:(t,e)=>{Tt(this,b,w).call(this,{type:"failed",failureCount:t,error:e})},onPause:()=>{Tt(this,b,w).call(this,{type:"pause"})},onContinue:()=>{Tt(this,b,w).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode})),xt(this,p,Qt(this,f).promise),Qt(this,p)}},u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,y=new WeakMap,v=new WeakMap,m=new WeakMap,b=new WeakSet,g=function(t){this.options=Et(Et({},Qt(this,v)),t),this.updateGcTime(this.options.gcTime)},w=function(t){this.state=(e=>{var s,i;switch(t.type){case"failed":return Ut(Et({},e),{fetchFailureCount:t.failureCount,fetchFailureReason:t.error});case"pause":return Ut(Et({},e),{fetchStatus:"paused"});case"continue":return Ut(Et({},e),{fetchStatus:"fetching"});case"fetch":return Et(Ut(Et({},e),{fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null!=(s=t.meta)?s:null,fetchStatus:he(this.options.networkMode)?"fetching":"paused"}),!e.dataUpdatedAt&&{error:null,status:"pending"});case"success":return Et(Ut(Et({},e),{data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:null!=(i=t.dataUpdatedAt)?i:Date.now(),error:null,isInvalidated:!1,status:"success"}),!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});case"error":const n=t.error;return ue(n)&&n.revert&&Qt(this,c)?Ut(Et({},Qt(this,c)),{fetchStatus:"idle"}):Ut(Et({},e),{error:n,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"});case"invalidate":return Ut(Et({},e),{isInvalidated:!0});case"setState":return Et(Et({},e),t.state)}})(this.state),de.batch(()=>{Qt(this,y).forEach(t=>{t.onQueryUpdate()}),Qt(this,d).notify({query:this,type:"updated",action:t})})},O);var ye=(k=class extends It{constructor(t={}){super(),Kt(this,M),this.config=t,xt(this,M,new Map)}build(t,e,s){var i;const n=e.queryKey,r=null!=(i=e.queryHash)?i:$t(n,e);let a=this.get(r);return a||(a=new fe({cache:this,queryKey:n,queryHash:r,options:t.defaultQueryOptions(e),state:s,defaultOptions:t.getQueryDefaults(n)}),this.add(a)),a}add(t){Qt(this,M).has(t.queryHash)||(Qt(this,M).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=Qt(this,M).get(t.queryHash);e&&(t.destroy(),e===t&&Qt(this,M).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){de.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Qt(this,M).get(t)}getAll(){return[...Qt(this,M).values()]}find(t){const e=Et({exact:!0},t);return this.getAll().find(t=>Nt(e,t))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(e=>Nt(t,e)):e}notify(t){de.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){de.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){de.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},M=new WeakMap,k),ve=(R=class extends pe{constructor(t){super(),Kt(this,q),Kt(this,P),Kt(this,S),Kt(this,F),Kt(this,C),this.mutationId=t.mutationId,xt(this,S,t.defaultOptions),xt(this,F,t.mutationCache),xt(this,P,[]),this.state=t.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=Et(Et({},Qt(this,S)),t),this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Qt(this,P).includes(t)||(Qt(this,P).push(t),this.clearGcTimeout(),Qt(this,F).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){xt(this,P,Qt(this,P).filter(e=>e!==t)),this.scheduleGc(),Qt(this,F).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Qt(this,P).length||("pending"===this.state.status?this.scheduleGc():Qt(this,F).remove(this))}continue(){var t,e;return null!=(e=null==(t=Qt(this,C))?void 0:t.continue())?e:this.execute(this.state.variables)}execute(t){return Lt(this,null,function*(){var e,s,i,n,r,a,o,h,l,u,c,d,p,f,y,v,m,b,g,w;const O=()=>{var e;return xt(this,C,ce({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(t,e)=>{Tt(this,q,W).call(this,{type:"failed",failureCount:t,error:e})},onPause:()=>{Tt(this,q,W).call(this,{type:"pause"})},onContinue:()=>{Tt(this,q,W).call(this,{type:"continue"})},retry:null!=(e=this.options.retry)?e:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode})),Qt(this,C).promise},M="pending"===this.state.status;try{if(!M){Tt(this,q,W).call(this,{type:"pending",variables:t}),yield null==(s=(e=Qt(this,F).config).onMutate)?void 0:s.call(e,t,this);const r=yield null==(n=(i=this.options).onMutate)?void 0:n.call(i,t);r!==this.state.context&&Tt(this,q,W).call(this,{type:"pending",context:r,variables:t})}const p=yield O();return yield null==(a=(r=Qt(this,F).config).onSuccess)?void 0:a.call(r,p,t,this.state.context,this),yield null==(h=(o=this.options).onSuccess)?void 0:h.call(o,p,t,this.state.context),yield null==(u=(l=Qt(this,F).config).onSettled)?void 0:u.call(l,p,null,this.state.variables,this.state.context,this),yield null==(d=(c=this.options).onSettled)?void 0:d.call(c,p,null,t,this.state.context),Tt(this,q,W).call(this,{type:"success",data:p}),p}catch(k){try{throw yield null==(f=(p=Qt(this,F).config).onError)?void 0:f.call(p,k,t,this.state.context,this),yield null==(v=(y=this.options).onError)?void 0:v.call(y,k,t,this.state.context),yield null==(b=(m=Qt(this,F).config).onSettled)?void 0:b.call(m,void 0,k,this.state.variables,this.state.context,this),yield null==(w=(g=this.options).onSettled)?void 0:w.call(g,void 0,k,t,this.state.context),k}finally{Tt(this,q,W).call(this,{type:"error",error:k})}}})}},P=new WeakMap,S=new WeakMap,F=new WeakMap,C=new WeakMap,q=new WeakSet,W=function(t){this.state=(e=>{switch(t.type){case"failed":return Ut(Et({},e),{failureCount:t.failureCount,failureReason:t.error});case"pause":return Ut(Et({},e),{isPaused:!0});case"continue":return Ut(Et({},e),{isPaused:!1});case"pending":return Ut(Et({},e),{context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!he(this.options.networkMode),status:"pending",variables:t.variables,submittedAt:Date.now()});case"success":return Ut(Et({},e),{data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return Ut(Et({},e),{data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"})}})(this.state),de.batch(()=>{Qt(this,P).forEach(e=>{e.onMutationUpdate(t)}),Qt(this,F).notify({mutation:this,type:"updated",action:t})})},R);var me=(D=class extends It{constructor(t={}){super(),Kt(this,A),Kt(this,E),Kt(this,U),this.config=t,xt(this,A,[]),xt(this,E,0)}build(t,e,s){const i=new ve({mutationCache:this,mutationId:++jt(this,E)._,options:t.defaultMutationOptions(e),state:s});return this.add(i),i}add(t){Qt(this,A).push(t),this.notify({type:"added",mutation:t})}remove(t){xt(this,A,Qt(this,A).filter(e=>e!==t)),this.notify({type:"removed",mutation:t})}clear(){de.batch(()=>{Qt(this,A).forEach(t=>{this.remove(t)})})}getAll(){return Qt(this,A)}find(t){const e=Et({exact:!0},t);return Qt(this,A).find(t=>zt(e,t))}findAll(t={}){return Qt(this,A).filter(e=>zt(t,e))}notify(t){de.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){var t;return xt(this,U,(null!=(t=Qt(this,U))?t:Promise.resolve()).then(()=>{const t=Qt(this,A).filter(t=>t.state.isPaused);return de.batch(()=>t.reduce((t,e)=>t.then(()=>e.continue().catch(Ht)),Promise.resolve()))}).then(()=>{xt(this,U,void 0)})),Qt(this,U)}},A=new WeakMap,E=new WeakMap,U=new WeakMap,D);function be(t){return{onFetch:(e,s)=>{const i=()=>Lt(this,null,function*(){var s,i,n,r,a,o;const h=e.options,l=null==(n=null==(i=null==(s=e.fetchOptions)?void 0:s.meta)?void 0:i.fetchMore)?void 0:n.direction,u=(null==(r=e.state.data)?void 0:r.pages)||[],c=(null==(a=e.state.data)?void 0:a.pageParams)||[],d={pages:[],pageParams:[]};let p=!1;const f=e.options.queryFn||(()=>Promise.reject(new Error(`Missing queryFn: '${e.options.queryHash}'`))),y=(t,s,i)=>Lt(this,null,function*(){if(p)return Promise.reject();if(null==s&&t.pages.length)return Promise.resolve(t);const n={queryKey:e.queryKey,pageParam:s,direction:i?"backward":"forward",meta:e.options.meta};var r;r=n,Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)});const a=yield f(n),{maxPages:o}=e.options,h=i?ne:ie;return{pages:h(t.pages,a,o),pageParams:h(t.pageParams,s,o)}});let v;if(l&&u.length){const t="backward"===l,e={pages:u,pageParams:c},s=(t?we:ge)(h,e);v=yield y(e,s,t)}else{v=yield y(d,null!=(o=c[0])?o:h.initialPageParam);const e=null!=t?t:u.length;for(let t=1;t<e;t++){const t=ge(h,v);v=yield y(v,t)}}return v});e.options.persister?e.fetchFn=()=>{var t,n;return null==(n=(t=e.options).persister)?void 0:n.call(t,i,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=i}}}function ge(t,{pages:e,pageParams:s}){const i=e.length-1;return t.getNextPageParam(e[i],e,s[i],s)}function we(t,{pages:e,pageParams:s}){var i;return null==(i=t.getPreviousPageParam)?void 0:i.call(t,e[0],e,s[0],s)}var Oe=(H=class{constructor(t={}){Kt(this,Q),Kt(this,K),Kt(this,x),Kt(this,T),Kt(this,j),Kt(this,L),Kt(this,I),Kt(this,G),xt(this,Q,t.queryCache||new ye),xt(this,K,t.mutationCache||new me),xt(this,x,t.defaultOptions||{}),xt(this,T,new Map),xt(this,j,new Map),xt(this,L,0)}mount(){jt(this,L)._++,1===Qt(this,L)&&(xt(this,I,re.subscribe(()=>{re.isFocused()&&(this.resumePausedMutations(),Qt(this,Q).onFocus())})),xt(this,G,ae.subscribe(()=>{ae.isOnline()&&(this.resumePausedMutations(),Qt(this,Q).onOnline())})))}unmount(){var t,e;jt(this,L)._--,0===Qt(this,L)&&(null==(t=Qt(this,I))||t.call(this),xt(this,I,void 0),null==(e=Qt(this,G))||e.call(this),xt(this,G,void 0))}isFetching(t){return Qt(this,Q).findAll(Ut(Et({},t),{fetchStatus:"fetching"})).length}isMutating(t){return Qt(this,K).findAll(Ut(Et({},t),{status:"pending"})).length}getQueryData(t){var e;return null==(e=Qt(this,Q).find({queryKey:t}))?void 0:e.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);return void 0!==e?Promise.resolve(e):this.fetchQuery(t)}getQueriesData(t){return this.getQueryCache().findAll(t).map(({queryKey:t,state:e})=>[t,e.data])}setQueryData(t,e,s){const i=Qt(this,Q).find({queryKey:t}),n=function(t,e){return"function"==typeof t?t(e):t}(e,null==i?void 0:i.state.data);if(void 0===n)return;const r=this.defaultQueryOptions({queryKey:t});return Qt(this,Q).build(this,r).setData(n,Ut(Et({},s),{manual:!0}))}setQueriesData(t,e,s){return de.batch(()=>this.getQueryCache().findAll(t).map(({queryKey:t})=>[t,this.setQueryData(t,e,s)]))}getQueryState(t){var e;return null==(e=Qt(this,Q).find({queryKey:t}))?void 0:e.state}removeQueries(t){const e=Qt(this,Q);de.batch(()=>{e.findAll(t).forEach(t=>{e.remove(t)})})}resetQueries(t,e){const s=Qt(this,Q),i=Et({type:"active"},t);return de.batch(()=>(s.findAll(t).forEach(t=>{t.reset()}),this.refetchQueries(i,e)))}cancelQueries(t={},e={}){const s=Et({revert:!0},e),i=de.batch(()=>Qt(this,Q).findAll(t).map(t=>t.cancel(s)));return Promise.all(i).then(Ht).catch(Ht)}invalidateQueries(t={},e={}){return de.batch(()=>{var s,i;if(Qt(this,Q).findAll(t).forEach(t=>{t.invalidate()}),"none"===t.refetchType)return Promise.resolve();const n=Ut(Et({},t),{type:null!=(i=null!=(s=t.refetchType)?s:t.type)?i:"active"});return this.refetchQueries(n,e)})}refetchQueries(t={},e){var s;const i=Ut(Et({},e),{cancelRefetch:null==(s=null==e?void 0:e.cancelRefetch)||s}),n=de.batch(()=>Qt(this,Q).findAll(t).filter(t=>!t.isDisabled()).map(t=>{let e=t.fetch(void 0,i);return i.throwOnError||(e=e.catch(Ht)),"paused"===t.state.fetchStatus?Promise.resolve():e}));return Promise.all(n).then(Ht)}fetchQuery(t){const e=this.defaultQueryOptions(t);void 0===e.retry&&(e.retry=!1);const s=Qt(this,Q).build(this,e);return s.isStaleByTime(e.staleTime)?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ht).catch(Ht)}fetchInfiniteQuery(t){return t.behavior=be(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ht).catch(Ht)}resumePausedMutations(){return Qt(this,K).resumePausedMutations()}getQueryCache(){return Qt(this,Q)}getMutationCache(){return Qt(this,K)}getDefaultOptions(){return Qt(this,x)}setDefaultOptions(t){xt(this,x,t)}setQueryDefaults(t,e){Qt(this,T).set(Jt(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...Qt(this,T).values()];let s={};return e.forEach(e=>{Vt(t,e.queryKey)&&(s=Et(Et({},s),e.defaultOptions))}),s}setMutationDefaults(t,e){Qt(this,j).set(Jt(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...Qt(this,j).values()];let s={};return e.forEach(e=>{Vt(t,e.mutationKey)&&(s=Et(Et({},s),e.defaultOptions))}),s}defaultQueryOptions(t){if(null==t?void 0:t._defaulted)return t;const e=Ut(Et(Et(Et({},Qt(this,x).queries),(null==t?void 0:t.queryKey)&&this.getQueryDefaults(t.queryKey)),t),{_defaulted:!0});return e.queryHash||(e.queryHash=$t(e.queryKey,e)),void 0===e.refetchOnReconnect&&(e.refetchOnReconnect="always"!==e.networkMode),void 0===e.throwOnError&&(e.throwOnError=!!e.suspense),void 0===e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e}defaultMutationOptions(t){return(null==t?void 0:t._defaulted)?t:Ut(Et(Et(Et({},Qt(this,x).mutations),(null==t?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey)),t),{_defaulted:!0})}clear(){Qt(this,Q).clear(),Qt(this,K).clear()}},Q=new WeakMap,K=new WeakMap,x=new WeakMap,T=new WeakMap,j=new WeakMap,L=new WeakMap,I=new WeakMap,G=new WeakMap,H),Me=(ft=class extends It{constructor(t,e){super(),Kt(this,nt),Kt(this,_),Kt(this,B),Kt(this,N),Kt(this,z),Kt(this,$),Kt(this,J),Kt(this,V),Kt(this,X),Kt(this,Y),Kt(this,Z),Kt(this,tt),Kt(this,et),Kt(this,st),Kt(this,it,new Set),this.options=e,xt(this,_,t),xt(this,V,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(Qt(this,B).addObserver(this),ke(Qt(this,B),this.options)?Tt(this,nt,rt).call(this):this.updateResult(),Tt(this,nt,lt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Pe(Qt(this,B),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Pe(Qt(this,B),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Tt(this,nt,ut).call(this),Tt(this,nt,ct).call(this),Qt(this,B).removeObserver(this)}setOptions(t,e){const s=this.options,i=Qt(this,B);if(this.options=Qt(this,_).defaultQueryOptions(t),Yt(s,this.options)||Qt(this,_).getQueryCache().notify({type:"observerOptionsUpdated",query:Qt(this,B),observer:this}),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled)throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=s.queryKey),Tt(this,nt,dt).call(this);const n=this.hasListeners();n&&Se(Qt(this,B),i,this.options,s)&&Tt(this,nt,rt).call(this),this.updateResult(e),!n||Qt(this,B)===i&&this.options.enabled===s.enabled&&this.options.staleTime===s.staleTime||Tt(this,nt,at).call(this);const r=Tt(this,nt,ot).call(this);!n||Qt(this,B)===i&&this.options.enabled===s.enabled&&r===Qt(this,st)||Tt(this,nt,ht).call(this,r)}getOptimisticResult(t){const e=Qt(this,_).getQueryCache().build(Qt(this,_),t),s=this.createResult(e,t);return function(t,e){if(!Yt(t.getCurrentResult(),e))return!0;return!1}(this,s)&&(xt(this,z,s),xt(this,J,this.options),xt(this,$,Qt(this,B).state)),s}getCurrentResult(){return Qt(this,z)}trackResult(t){const e={};return Object.keys(t).forEach(s=>{Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:()=>(Qt(this,it).add(s),t[s])})}),e}getCurrentQuery(){return Qt(this,B)}refetch(t={}){var e=((t,e)=>{var s={};for(var i in t)Ct.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&Ft)for(var i of Ft(t))e.indexOf(i)<0&&qt.call(t,i)&&(s[i]=t[i]);return s})(t,[]);return this.fetch(Et({},e))}fetchOptimistic(t){const e=Qt(this,_).defaultQueryOptions(t),s=Qt(this,_).getQueryCache().build(Qt(this,_),e);return s.isFetchingOptimistic=!0,s.fetch().then(()=>this.createResult(s,e))}fetch(t){var e;return Tt(this,nt,rt).call(this,Ut(Et({},t),{cancelRefetch:null==(e=t.cancelRefetch)||e})).then(()=>(this.updateResult(),Qt(this,z)))}createResult(t,e){var s;const i=Qt(this,B),n=this.options,r=Qt(this,z),a=Qt(this,$),o=Qt(this,J),h=t!==i?t.state:Qt(this,N),{state:l}=t;let u,{error:c,errorUpdatedAt:d,fetchStatus:p,status:f}=l,y=!1;if(e._optimisticResults){const s=this.hasListeners(),r=!s&&ke(t,e),a=s&&Se(t,i,e,n);(r||a)&&(p=he(t.options.networkMode)?"fetching":"paused",l.dataUpdatedAt||(f="pending")),"isRestoring"===e._optimisticResults&&(p="idle")}if(e.select&&void 0!==l.data)if(r&&l.data===(null==a?void 0:a.data)&&e.select===Qt(this,X))u=Qt(this,Y);else try{xt(this,X,e.select),u=e.select(l.data),u=se(null==r?void 0:r.data,u,e),xt(this,Y,u),xt(this,V,null)}catch(w){xt(this,V,w)}else u=l.data;if(void 0!==e.placeholderData&&void 0===u&&"pending"===f){let t;if((null==r?void 0:r.isPlaceholderData)&&e.placeholderData===(null==o?void 0:o.placeholderData))t=r.data;else if(t="function"==typeof e.placeholderData?e.placeholderData(null==(s=Qt(this,Z))?void 0:s.state.data,Qt(this,Z)):e.placeholderData,e.select&&void 0!==t)try{t=e.select(t),xt(this,V,null)}catch(w){xt(this,V,w)}void 0!==t&&(f="success",u=se(null==r?void 0:r.data,t,e),y=!0)}Qt(this,V)&&(c=Qt(this,V),u=Qt(this,Y),d=Date.now(),f="error");const v="fetching"===p,m="pending"===f,b="error"===f,g=m&&v;return{status:f,fetchStatus:p,isPending:m,isSuccess:"success"===f,isError:b,isInitialLoading:g,isLoading:g,data:u,dataUpdatedAt:l.dataUpdatedAt,error:c,errorUpdatedAt:d,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>h.dataUpdateCount||l.errorUpdateCount>h.errorUpdateCount,isFetching:v,isRefetching:v&&!m,isLoadingError:b&&0===l.dataUpdatedAt,isPaused:"paused"===p,isPlaceholderData:y,isRefetchError:b&&0!==l.dataUpdatedAt,isStale:Fe(t,e),refetch:this.refetch}}updateResult(t){const e=Qt(this,z),s=this.createResult(Qt(this,B),this.options);if(xt(this,$,Qt(this,B).state),xt(this,J,this.options),void 0!==Qt(this,$).data&&xt(this,Z,Qt(this,B)),Yt(s,e))return;xt(this,z,s);const i={};!1!==(null==t?void 0:t.listeners)&&(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!Qt(this,it).size)return!0;const i=new Set(null!=s?s:Qt(this,it));return this.options.throwOnError&&i.add("error"),Object.keys(Qt(this,z)).some(t=>{const s=t;return Qt(this,z)[s]!==e[s]&&i.has(s)})})()&&(i.listeners=!0),Tt(this,nt,pt).call(this,Et(Et({},i),t))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Tt(this,nt,lt).call(this)}},_=new WeakMap,B=new WeakMap,N=new WeakMap,z=new WeakMap,$=new WeakMap,J=new WeakMap,V=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,it=new WeakMap,nt=new WeakSet,rt=function(t){Tt(this,nt,dt).call(this);let e=Qt(this,B).fetch(this.options,t);return(null==t?void 0:t.throwOnError)||(e=e.catch(Ht)),e},at=function(){if(Tt(this,nt,ut).call(this),Gt||Qt(this,z).isStale||!_t(this.options.staleTime))return;const t=Bt(Qt(this,z).dataUpdatedAt,this.options.staleTime);xt(this,tt,setTimeout(()=>{Qt(this,z).isStale||this.updateResult()},t+1))},ot=function(){var t;return null!=(t="function"==typeof this.options.refetchInterval?this.options.refetchInterval(Qt(this,B)):this.options.refetchInterval)&&t},ht=function(t){Tt(this,nt,ct).call(this),xt(this,st,t),!Gt&&!1!==this.options.enabled&&_t(Qt(this,st))&&0!==Qt(this,st)&&xt(this,et,setInterval(()=>{(this.options.refetchIntervalInBackground||re.isFocused())&&Tt(this,nt,rt).call(this)},Qt(this,st)))},lt=function(){Tt(this,nt,at).call(this),Tt(this,nt,ht).call(this,Tt(this,nt,ot).call(this))},ut=function(){Qt(this,tt)&&(clearTimeout(Qt(this,tt)),xt(this,tt,void 0))},ct=function(){Qt(this,et)&&(clearInterval(Qt(this,et)),xt(this,et,void 0))},dt=function(){const t=Qt(this,_).getQueryCache().build(Qt(this,_),this.options);if(t===Qt(this,B))return;const e=Qt(this,B);xt(this,B,t),xt(this,N,t.state),this.hasListeners()&&(null==e||e.removeObserver(this),t.addObserver(this))},pt=function(t){de.batch(()=>{t.listeners&&this.listeners.forEach(t=>{t(Qt(this,z))}),Qt(this,_).getQueryCache().notify({query:Qt(this,B),type:"observerResultsUpdated"})})},ft);function ke(t,e){return function(t,e){return!(!1===e.enabled||t.state.dataUpdatedAt||"error"===t.state.status&&!1===e.retryOnMount)}(t,e)||t.state.dataUpdatedAt>0&&Pe(t,e,e.refetchOnMount)}function Pe(t,e,s){if(!1!==e.enabled){const i="function"==typeof s?s(t):s;return"always"===i||!1!==i&&Fe(t,e)}return!1}function Se(t,e,s,i){return!1!==s.enabled&&(t!==e||!1===i.enabled)&&(!s.suspense||"error"!==t.state.status)&&Fe(t,s)}function Fe(t,e){return t.isStaleByTime(e.staleTime)}var Ce=(Mt=class extends It{constructor(t,e){super(),Kt(this,gt),Kt(this,yt),Kt(this,vt),Kt(this,mt),Kt(this,bt),xt(this,vt,void 0),xt(this,yt,t),this.setOptions(e),this.bindMethods(),Tt(this,gt,wt).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=Qt(this,yt).defaultMutationOptions(t),Yt(s,this.options)||Qt(this,yt).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Qt(this,mt),observer:this}),null==(e=Qt(this,mt))||e.setOptions(this.options),(null==s?void 0:s.mutationKey)&&this.options.mutationKey&&Jt(s.mutationKey)!==Jt(this.options.mutationKey)&&this.reset()}onUnsubscribe(){var t;this.hasListeners()||null==(t=Qt(this,mt))||t.removeObserver(this)}onMutationUpdate(t){Tt(this,gt,wt).call(this),Tt(this,gt,Ot).call(this,t)}getCurrentResult(){return Qt(this,vt)}reset(){var t;null==(t=Qt(this,mt))||t.removeObserver(this),xt(this,mt,void 0),Tt(this,gt,wt).call(this),Tt(this,gt,Ot).call(this)}mutate(t,e){var s;return xt(this,bt,e),null==(s=Qt(this,mt))||s.removeObserver(this),xt(this,mt,Qt(this,yt).getMutationCache().build(Qt(this,yt),this.options)),Qt(this,mt).addObserver(this),Qt(this,mt).execute(t)}},yt=new WeakMap,vt=new WeakMap,mt=new WeakMap,bt=new WeakMap,gt=new WeakSet,wt=function(){var t,e;const s=null!=(e=null==(t=Qt(this,mt))?void 0:t.state)?e:{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};xt(this,vt,Ut(Et({},s),{isPending:"pending"===s.status,isSuccess:"success"===s.status,isError:"error"===s.status,isIdle:"idle"===s.status,mutate:this.mutate,reset:this.reset}))},Ot=function(t){de.batch(()=>{var e,s,i,n,r,a,o,h;if(Qt(this,bt)&&this.hasListeners()){const l=Qt(this,vt).variables,u=Qt(this,vt).context;"success"===(null==t?void 0:t.type)?(null==(s=(e=Qt(this,bt)).onSuccess)||s.call(e,t.data,l,u),null==(n=(i=Qt(this,bt)).onSettled)||n.call(i,t.data,null,l,u)):"error"===(null==t?void 0:t.type)&&(null==(a=(r=Qt(this,bt)).onError)||a.call(r,t.error,l,u),null==(h=(o=Qt(this,bt)).onSettled)||h.call(o,void 0,t.error,l,u))}this.listeners.forEach(t=>{t(Qt(this,vt))})})},Mt);export{me as M,Oe as Q,ye as a,Me as b,Ce as c,de as n};

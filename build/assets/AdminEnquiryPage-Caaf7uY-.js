import{a as A,aq as z,A as D,a1 as M,j as e,d as y}from"./index-0GGCgQc5.js";import{A as T,u as W}from"./get-all-enquiry-admin.query-dI9k1Dfg.js";import{u as L}from"./useMutation-DW6lAXSi.js";import{a as P}from"./AdminStyles-CJTdh0rH.js";const H="enquiry-by-id",N=i=>A({queryKey:[H,i],queryFn:async()=>i?(await z.getEnquiryById(i)).data:void 0}),q=()=>{const{show:i}=D(),l=M();return L({mutationFn:async n=>(await z.makeEnquiryResolved(n)).data,onSuccess:()=>{l.invalidateQueries({queryKey:[T]}),i({title:"Enquiry resolved successfully",color:"Success"})},onError:()=>{i({title:"Failed to resolve enquiry",color:"Error"})}})},s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},modal:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflow:"hidden",position:"relative",animation:"modalSlideIn 0.3s ease-out"},header:{padding:"24px 32px 16px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},title:{fontSize:"24px",fontWeight:"700",color:"#1e293b",margin:0,fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},closeButton:{background:"none",border:"none",fontSize:"24px",color:"#64748b",cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px","&:hover":{backgroundColor:"#f1f5f9",color:"#1e293b"}},content:{padding:"32px",maxHeight:"calc(90vh - 120px)",overflowY:"auto"},section:{marginBottom:"24px"},sectionTitle:{fontSize:"14px",fontWeight:"600",color:"#64748b",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"8px",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},sectionContent:{fontSize:"16px",color:"#1e293b",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},userInfo:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px",padding:"20px",backgroundColor:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},avatar:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#3b82f6",color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",fontWeight:"600",flexShrink:0},userDetails:{flex:1},userName:{fontSize:"20px",fontWeight:"600",color:"#1e293b",marginBottom:"4px",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},userEmail:{fontSize:"14px",color:"#64748b",marginBottom:"4px",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},userPhone:{fontSize:"14px",color:"#64748b",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},messageContainer:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"12px",padding:"20px",maxHeight:"150px",overflowY:"auto"},messageText:{fontSize:"16px",lineHeight:"1.6",color:"#374151",whiteSpace:"pre-wrap",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},statusBadge:{display:"inline-flex",alignItems:"center",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},statusResolved:{backgroundColor:"#dcfce7",color:"#166534"},statusPending:{backgroundColor:"#fef3c7",color:"#92400e"},dateInfo:{display:"flex",gap:"24px",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #e2e8f0"},dateItem:{flex:1},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 32px",gap:"16px"},loadingSpinner:{width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"},errorContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 32px",gap:"16px",color:"#dc2626"}},K=({enquiryId:i,onClose:l})=>{var a,j,v,f,p,h,k,S,x,c,g,u,m,o,r,d,R,E,F;const{data:n,isLoading:b,error:B}=N(i),w=I=>{I.target===I.currentTarget&&l()},C=I=>{I.key==="Escape"&&l()};return i?e.jsxs("div",{style:s.overlay,onClick:w,onKeyDown:C,tabIndex:-1,children:[e.jsxs("div",{style:s.modal,children:[e.jsxs("div",{style:s.header,children:[e.jsx("h2",{style:s.title,children:"Enquiry Details"}),e.jsx("button",{onClick:l,style:s.closeButton,"aria-label":"Close modal",children:"✕"})]}),e.jsx("div",{style:s.content,children:b?e.jsxs("div",{style:s.loadingContainer,children:[e.jsx("div",{style:s.loadingSpinner}),e.jsx("p",{children:"Loading enquiry details..."})]}):B?e.jsxs("div",{style:s.errorContainer,children:[e.jsx("h3",{children:"Error loading enquiry"}),e.jsx("p",{children:"Please try again later."})]}):n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:s.userInfo,children:[e.jsx("div",{style:s.avatar,children:(v=(j=(a=n==null?void 0:n.data)==null?void 0:a.enquiryById)==null?void 0:j.fullName)==null?void 0:v.charAt(0).toUpperCase()}),e.jsxs("div",{style:s.userDetails,children:[e.jsx("div",{style:s.userName,children:(p=(f=n==null?void 0:n.data)==null?void 0:f.enquiryById)==null?void 0:p.fullName}),e.jsx("div",{style:s.userEmail,children:(k=(h=n==null?void 0:n.data)==null?void 0:h.enquiryById)==null?void 0:k.email}),e.jsx("div",{style:s.userPhone,children:(x=(S=n==null?void 0:n.data)==null?void 0:S.enquiryById)==null?void 0:x.phone})]}),e.jsx("div",{style:{...s.statusBadge,...(g=(c=n==null?void 0:n.data)==null?void 0:c.enquiryById)!=null&&g.isResolved?s.statusResolved:s.statusPending},children:(m=(u=n==null?void 0:n.data)==null?void 0:u.enquiryById)!=null&&m.isResolved?"Resolved":"Pending"})]}),e.jsxs("div",{style:s.section,children:[e.jsx("div",{style:s.sectionTitle,children:"Message"}),e.jsx("div",{style:s.messageContainer,children:e.jsx("div",{style:s.messageText,children:(r=(o=n==null?void 0:n.data)==null?void 0:o.enquiryById)==null?void 0:r.message})})]}),e.jsxs("div",{style:s.dateInfo,children:[e.jsxs("div",{style:s.dateItem,children:[e.jsx("div",{style:s.sectionTitle,children:"Created"}),e.jsx("div",{style:s.sectionContent,children:new Date(((R=(d=n==null?void 0:n.data)==null?void 0:d.enquiryById)==null?void 0:R.createdAt)||"").toLocaleString()})]}),e.jsxs("div",{style:s.dateItem,children:[e.jsx("div",{style:s.sectionTitle,children:"Last Updated"}),e.jsx("div",{style:s.sectionContent,children:new Date(((F=(E=n==null?void 0:n.data)==null?void 0:E.enquiryById)==null?void 0:F.updatedAt)||"").toLocaleString()})]})]})]}):null})]}),e.jsx("style",{children:`
          @keyframes modalSlideIn {
            from {
              opacity: 0;
              transform: scale(0.9) translateY(-20px);
            }
            to {
              opacity: 1;
              transform: scale(1) translateY(0);
            }
          }
          
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `})]}):null},t={header:{marginBottom:"32px",textAlign:"start"},title:{fontSize:"32px",fontWeight:"700",color:"#1e293b",marginBottom:"8px",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},subtitle:{fontSize:"16px",color:"#64748b",margin:"0",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},searchContainer:{marginBottom:"24px",marginLeft:"auto"},searchWrapper:{position:"relative",maxWidth:"400px",marginLeft:"auto"},searchInput:{width:"100%",padding:"16px 48px 16px 16px",border:"2px solid #e2e8f0",borderRadius:"12px",fontSize:"16px",color:"#1e293b",backgroundColor:"#ffffff",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif',transition:"all 0.2s ease",outline:"none"},searchIcon:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",fontSize:"18px",color:"#64748b",pointerEvents:"none"},tableContainer:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",overflow:"hidden",border:"1px solid #e2e8f0"},table:{width:"100%",borderCollapse:"collapse",fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, sans-serif'},tableHeader:{backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},tableHeaderCell:{padding:"20px 16px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.5px"},tableRow:{borderBottom:"1px solid #f1f5f9",transition:"background-color 0.2s ease",cursor:"pointer","&:hover":{backgroundColor:"#f8fafc"}},tableCell:{padding:"16px",fontSize:"14px",color:"#374151",verticalAlign:"middle"},nameCell:{display:"flex",alignItems:"center",gap:"12px"},avatar:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#3b82f6",color:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"600",flexShrink:0},emailLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}},phoneLink:{color:"#059669",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}},messageCell:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},statusCell:{display:"flex",alignItems:"center",gap:"12px"},switch:{position:"relative",display:"inline-block",width:"50px",height:"24px"},switchInput:{opacity:0,width:0,height:0},slider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#cbd5e1",transition:"0.3s",borderRadius:"24px"},sliderBefore:{position:"absolute",content:'""',height:"18px",width:"18px",left:"3px",bottom:"3px",backgroundColor:"#ffffff",transition:"0.3s",borderRadius:"50%"},sliderChecked:{backgroundColor:"#10b981"},sliderBeforeChecked:{transform:"translateX(26px)"},statusText:{fontSize:"12px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},noDataCell:{textAlign:"center",padding:"48px 16px",color:"#64748b",fontSize:"16px"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"48px 16px",gap:"16px"},loadingSpinner:{width:"32px",height:"32px",border:"3px solid #e2e8f0",borderTop:"3px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"},errorContainer:{textAlign:"center",padding:"48px 16px",color:"#dc2626"},paginationContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px",padding:"24px 16px",borderTop:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},paginationButton:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6",borderColor:"#9ca3af"},"&:disabled":{backgroundColor:"#f9fafb",color:"#9ca3af",cursor:"not-allowed",borderColor:"#e5e7eb"}},paginationButtonDisabled:{backgroundColor:"#f9fafb",color:"#9ca3af",cursor:"not-allowed",borderColor:"#e5e7eb"},pageNumbers:{display:"flex",gap:"8px"},pageButton:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",minWidth:"36px","&:hover":{backgroundColor:"#f3f4f6",borderColor:"#9ca3af"}},pageButtonActive:{backgroundColor:"#3b82f6",color:"#ffffff",borderColor:"#3b82f6","&:hover":{backgroundColor:"#2563eb",borderColor:"#2563eb"}},summary:{padding:"16px",textAlign:"center",color:"#64748b",fontSize:"14px",borderTop:"1px solid #e2e8f0",backgroundColor:"#f8fafc"}},Q=()=>{var g,u,m;const[i,l]=y.useState(1),[n,b]=y.useState(""),[B]=y.useState(10),[w,C]=y.useState(void 0),{data:a,isLoading:j,error:v}=W({page:i,limit:B}),f=q(),p=y.useMemo(()=>{var r;if(!((r=a==null?void 0:a.data)!=null&&r.enquiries))return[];if(!n.trim())return a.data.enquiries;const o=n.toLowerCase();return a.data.enquiries.filter(d=>d.fullName.toLowerCase().includes(o)||d.email.toLowerCase().includes(o)||d.phone.includes(n))},[(g=a==null?void 0:a.data)==null?void 0:g.enquiries,n]),h=async(o,r,d)=>{d.stopPropagation(),r||await f.mutateAsync(o)},k=o=>{C(o)},S=()=>{C(void 0)},x=o=>{l(o)},c=((u=a==null?void 0:a.data)==null?void 0:u.totalPages)||1;return v?e.jsx("div",{style:P.container,children:e.jsxs("div",{style:t.errorContainer,children:[e.jsx("h2",{children:"Error loading enquiries"}),e.jsx("p",{children:"Please try again later."})]})}):e.jsxs("div",{style:P.container,children:[e.jsxs("div",{style:t.header,children:[e.jsx("h1",{style:t.title,children:"Enquiry Management"}),e.jsx("p",{style:t.subtitle,children:"Manage and resolve customer enquiries"})]}),e.jsx("div",{style:t.searchContainer,children:e.jsxs("div",{style:t.searchWrapper,children:[e.jsx("input",{type:"text",placeholder:"Search by name, email, or phone number...",value:n,onChange:o=>b(o.target.value),style:t.searchInput}),e.jsx("div",{style:t.searchIcon,children:"🔍"})]})}),e.jsx("div",{style:t.tableContainer,children:j?e.jsxs("div",{style:t.loadingContainer,children:[e.jsx("div",{style:t.loadingSpinner}),e.jsx("p",{children:"Loading enquiries..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{style:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{style:t.tableHeader,children:[e.jsx("th",{style:t.tableHeaderCell,children:"Name"}),e.jsx("th",{style:t.tableHeaderCell,children:"Email"}),e.jsx("th",{style:t.tableHeaderCell,children:"Phone"}),e.jsx("th",{style:t.tableHeaderCell,children:"Message"}),e.jsx("th",{style:t.tableHeaderCell,children:"Status"}),e.jsx("th",{style:t.tableHeaderCell,children:"Date"})]})}),e.jsx("tbody",{children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:t.noDataCell,children:"No enquiries found"})}):p.map(o=>e.jsxs("tr",{style:t.tableRow,onClick:r=>{r.stopPropagation(),k(o._id)},children:[e.jsx("td",{style:t.tableCell,children:e.jsxs("div",{style:t.nameCell,children:[e.jsx("div",{style:t.avatar,children:o.fullName.charAt(0).toUpperCase()}),e.jsx("span",{children:o.fullName})]})}),e.jsx("td",{style:t.tableCell,children:e.jsx("a",{href:`mailto:${o.email}`,style:t.emailLink,onClick:r=>r.stopPropagation(),children:o.email})}),e.jsx("td",{style:t.tableCell,children:e.jsx("a",{href:`tel:${o.phone}`,style:t.phoneLink,onClick:r=>r.stopPropagation(),children:o.phone})}),e.jsx("td",{style:t.tableCell,children:e.jsx("div",{style:t.messageCell,children:o.message.length>50?`${o.message.substring(0,50)}...`:o.message})}),e.jsx("td",{style:t.tableCell,onClick:r=>r.stopPropagation(),children:e.jsxs("div",{style:t.statusCell,children:[e.jsxs("label",{style:t.switch,children:[e.jsx("input",{type:"checkbox",checked:o.isResolved,onChange:r=>{r.stopPropagation(),h(o._id,o.isResolved,{})},onClick:r=>{r.stopPropagation(),h(o._id,o.isResolved,r)},disabled:f.isPending,style:t.switchInput}),e.jsx("span",{style:{...t.slider,...o.isResolved&&t.sliderChecked},children:e.jsx("span",{style:{...t.sliderBefore,...o.isResolved&&t.sliderBeforeChecked}})})]}),e.jsx("span",{style:{...t.statusText,color:o.isResolved?"#10b981":"#6b7280"},children:o.isResolved?"Resolved":"Pending"})]})}),e.jsx("td",{style:t.tableCell,children:new Date(o.createdAt).toLocaleDateString()})]},o._id))})]}),c>1&&e.jsxs("div",{style:t.paginationContainer,children:[e.jsx("button",{onClick:()=>x(i-1),disabled:i===1,style:{...t.paginationButton,...i===1&&t.paginationButtonDisabled},children:"Previous"}),e.jsx("div",{style:t.pageNumbers,children:Array.from({length:c},(o,r)=>r+1).map(o=>e.jsx("button",{onClick:()=>x(o),style:{...t.pageButton,...i===o&&t.pageButtonActive},children:o},o))}),e.jsx("button",{onClick:()=>x(i+1),disabled:i===c,style:{...t.paginationButton,...i===c&&t.paginationButtonDisabled},children:"Next"})]}),e.jsx("div",{style:t.summary,children:e.jsxs("p",{children:["Showing ",p.length," of ",((m=a==null?void 0:a.data)==null?void 0:m.total)||0," ","enquiries",n&&` (filtered by "${n}")`]})})]})}),e.jsx(K,{enquiryId:w,onClose:S}),e.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `})]})},O=()=>e.jsx(Q,{});export{O as default};

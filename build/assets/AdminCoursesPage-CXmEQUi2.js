import{A as M,a1 as H,a5 as L,j as e,M as Le,l as n,T as u,Y as p,n as Oe,a3 as D,d as l,a2 as R,G as z,g as W,S as Ge,a6 as Qe}from"./index-0GGCgQc5.js";import{a as _e}from"./get-course-by-id.query-CExZcCgv.js";import{A as O,u as Ue}from"./get-all-cources-for-admin.query-B8jBOj6j.js";import{u as Ve,C as ge,o as qe}from"./yup-l7oKxK6W.js";import{u as G}from"./useMutation-DW6lAXSi.js";import{a as Ke,C as Ne,S as Ye,V as fe,b as $e}from"./ConfirmDialog-CW7dtUG5.js";import{T as Je,a as Xe,b as he,c as Ze,G as er}from"./styles.component-DLLUe8t5.js";import{A as w}from"./Alert-DH6aySMM.js";import{I as rr}from"./InputAdornment-BltocGSA.js";import{T as tr,a as or,b as sr,c as be,d as c,e as ir,f as Ce}from"./TableRow-BfCpx3__.js";import{C as ar}from"./Chip-BUZF0xjW.js";import{E as je}from"./Edit-uN2shas0.js";import{D as ye}from"./Delete-CS6izGUm.js";const nr=()=>{const{show:d}=M(),a=H();return G({mutationFn:async({course:o,imageFile:s})=>(await L.createCourse(o,s)).data,onSuccess:()=>{a.invalidateQueries({queryKey:[O]}),d({title:"Course created successfully",color:"Success"})},onError:o=>{var s;d({title:((s=o.response)==null?void 0:s.data.message)||o.message||"Failed to create course",color:"Error"})}})},lr=()=>{const d=H(),{show:a}=M();return G({mutationFn:async({courseId:o,coursePayload:s,imageFile:g})=>(await L.updateCourses({courseId:o,coursePayload:s,imageFile:g})).data,onSuccess:()=>{d.invalidateQueries({queryKey:[O]}),a({title:"Course updated successfully",color:"Success"})},onError:o=>{var s;a({title:((s=o.response)==null?void 0:s.data.message)||o.message||"Failed to update course",color:"Error"})}})},dr=()=>{const d=H(),{show:a}=M();return G({mutationFn:async o=>(await L.deleteCourse(o)).data,onSuccess:()=>{d.invalidateQueries({queryKey:[O]}),a({title:"Course deleted successfully",color:"Success"})},onError:o=>{var s;a({title:((s=o.response)==null?void 0:s.data.message)||o.message||"Failed to delete course",color:"Error"})}})},cr={width:"100%",padding:"0.75rem",border:"1px solid #cbd5e1",borderRadius:"0.5rem",fontSize:"1rem",transition:"all 0.2s ease-in-out",fontFamily:'"Inter", sans-serif'},S={padding:"0.75rem 1.25rem",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:600,transition:"all 0.2s ease-in-out",border:"1px solid transparent",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontFamily:'"Inter", sans-serif',whiteSpace:"nowrap",textTransform:"none"},t={container:{maxWidth:"1200px",margin:{xs:"1rem",md:"2rem auto"},padding:{xs:"1rem",md:"1.5rem"},backgroundColor:"#ffffff",borderRadius:"1rem",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.08)"},header:{marginBottom:"1.5rem",color:"#1e293b",textAlign:"center",fontSize:{xs:"1.75rem",md:"2.25rem"},fontWeight:700},subHeader:{marginBottom:"1.5rem",color:"#334155",fontSize:{xs:"1.5rem",md:"1.75rem"},fontWeight:600},formContainer:{padding:{xs:"1rem",md:"2rem"},borderRadius:"0.75rem",backgroundColor:"#f8fafc",marginBottom:"2rem"},inputField:{marginBottom:"1.5rem","& .MuiOutlinedInput-root":{...cr,backgroundColor:"#ffffff","& fieldset":{borderColor:"#e2e8f0"},"&:hover fieldset":{borderColor:"#94a3b8"},"&.Mui-focused fieldset":{borderColor:"#007bff",borderWidth:"2px"}},"& .MuiInputLabel-root":{color:"#64748b"},"& .MuiFormHelperText-root":{color:"#ef4444"}},imageUploadContainer:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"1rem"},uploadButton:{...S,backgroundColor:"#e0f2fe",color:"#0288d1",border:"1px solid #90caf9","&:hover":{backgroundColor:"#90caf9",color:"#ffffff"}},imagePreviewBox:{position:"relative",width:"150px",height:"100px",borderRadius:"0.5rem",overflow:"hidden",border:"1px solid #e2e8f0",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f0f0f0"},removeImageButton:{position:"absolute",top:5,right:5,backgroundColor:"rgba(255,255,255,0.7)","&:hover":{backgroundColor:"rgba(255,255,255,0.9)"},minWidth:0,padding:"4px"},submitButton:{...S,backgroundColor:"#10b981",color:"#ffffff","&:hover":{backgroundColor:"#059669"},"&:disabled":{backgroundColor:"#a7f3d0",color:"#ffffff",cursor:"not-allowed"}},cancelEditButton:{...S,backgroundColor:"transparent",color:"#64748b",border:"1px solid #cbd5e1","&:hover":{backgroundColor:"#f1f5f9",borderColor:"#94a3b8"},marginLeft:"1rem"},alert:{marginBottom:"1rem",borderRadius:"0.5rem"},searchAndSwitchContainer:{display:"flex",justifyContent:"flex-end",marginBottom:"1.5rem",gap:"1rem",flexWrap:"wrap","@media (max-width: 600px)":{flexDirection:"column",alignItems:"stretch"}},searchField:{width:"300px","@media (max-width: 600px)":{width:"100%"}},loadingBox:{display:"flex",justifyContent:"center",paddingY:"2rem"},tableContainer:{boxShadow:"0 4px 20px rgba(0, 0, 0, 0.05)",borderRadius:"0.75rem",overflow:"hidden"},tableHeader:{fontWeight:700,backgroundColor:"#f8fafc",color:"#334155",whiteSpace:"nowrap",padding:"1rem"},tableRow:{"&:nth-of-type(odd)":{backgroundColor:"#fefefe"},"&:hover":{backgroundColor:"#f0f4f8"}},tableCell:{color:"#475569",padding:"0.75rem 1rem"},tableActions:{display:"flex",justifyContent:"flex-end",gap:"0.5rem","& .MuiIconButton-root":{padding:"6px","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}},courseGrid:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(auto-fill, minmax(280px, 1fr))"},gap:"1.5rem"},courseCard:{backgroundColor:"#ffffff",borderRadius:"0.75rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.05)",overflow:"hidden",display:"flex",flexDirection:"column",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-5px)",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)"}},courseCardContent:{padding:"1rem",display:"flex",flexDirection:"column",flexGrow:1},courseCardTitle:{fontSize:"1.25rem",fontWeight:600,color:"#1e293b",marginBottom:"0.5rem"},courseCardDescription:{fontSize:"0.875rem",color:"#475569",marginBottom:"1rem",flexGrow:1,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},courseCardActions:{display:"flex",gap:"0.5rem",marginTop:"1rem",flexWrap:"wrap","& .action-button":{...S,padding:"0.5rem 0.75rem",fontSize:"0.875rem",fontWeight:500,flexGrow:1,minWidth:"unset","& svg":{marginRight:"0.25rem"}},"& .edit-button":{backgroundColor:"#ffedd5",color:"#f97316","&:hover":{backgroundColor:"#fed7aa"}},"& .delete-button":{backgroundColor:"#fee2e2",color:"#ef4444","&:hover":{backgroundColor:"#fecaca"}},"& .view-button":{backgroundColor:"#e0f7fa",color:"#00bcd4","&:hover":{backgroundColor:"#b2ebf2"}}},paginationContainer:{display:"flex",justifyContent:"center",marginTop:"1.5rem",padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"0.75rem",boxShadow:"0 2px 8px rgba(0,0,0,0.04)","@media (max-width: 600px)":{flexDirection:"column",alignItems:"center"}}},ur="https://digitallearning.eletsonline.com/wp-content/uploads/2019/03/Online-courses.jpg",mr=({open:d,onClose:a,course:o,loading:s})=>e.jsx(Le,{open:d,onClose:a,"aria-labelledby":"course-details-modal-title","aria-describedby":"course-details-description",sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(n,{sx:{bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4,minWidth:350,maxWidth:500,width:"90%",outline:"none"},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",mb:2},children:[e.jsx(u,{id:"course-details-modal-title",variant:"h6",component:"h2",children:"Course Detail"}),e.jsx(p,{onClick:a,"aria-label":"close",children:e.jsx(Oe,{})})]}),s?e.jsx(n,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(D,{})}):o?e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{mt:2,display:"flex",justifyContent:"center",alignItems:"center",bgcolor:"#f5f7fa",borderRadius:2,minHeight:150,overflow:"hidden"},children:e.jsx("img",{src:o.image||ur,alt:o.title||"Course Image",style:{maxWidth:"100%",maxHeight:200,width:"100%",objectFit:"cover",borderRadius:8}})}),e.jsxs(n,{sx:{mt:2},children:[e.jsx(u,{variant:"h5",component:"h2",sx:{whiteSpace:"pre-wrap",wordWrap:"break-word"},gutterBottom:!0,children:o.title}),e.jsx(u,{variant:"body1",color:"text.secondary",sx:{mb:2,whiteSpace:"pre-wrap",wordWrap:"break-word"},children:o.description}),o.price!==void 0&&e.jsxs(u,{variant:"h6",color:"primary.main",children:["Price: â‚¹",o.price.toFixed(2)]}),o.createdBy&&typeof o.createdBy!="string"&&e.jsxs(u,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Created by: ",o.createdBy.name," (",o.createdBy.email,")"]})]})]}):e.jsx(n,{sx:{py:4,textAlign:"center",color:"text.secondary"},children:e.jsx(u,{children:"No course data available."})})]})}),ve="https://placehold.co/600x400?text=Course",xr=()=>{var te,oe,se,ie,ae,ne,le,de,ce,ue,me,xe,pe;const[d,a]=l.useState(null),[o,s]=l.useState(null),[g,Q]=l.useState(()=>localStorage.getItem("courseView")||"table"),[we,_]=l.useState(!1),[Se,U]=l.useState(null),[m,A]=l.useState(null),[Ae,k]=l.useState(!1),[V,B]=l.useState(null),[I,q]=l.useState(0),[P,ke]=l.useState(10),[T,Be]=l.useState(""),[Ie,Pe]=l.useState(""),{data:b,isLoading:Te,isError:Ee,error:E,refetch:K}=Ue({page:I+1,limit:P,search:Ie}),{data:y,isLoading:Fe}=_e(m||void 0),f=nr(),h=lr(),x=dr(),{handleSubmit:Re,control:N,reset:v,setValue:C,formState:{errors:j,isSubmitting:Y}}=Ve({resolver:qe(Qe),defaultValues:{title:"",description:"",image:void 0}});l.useEffect(()=>{const r=setTimeout(()=>{Pe(T)},500);return()=>clearTimeout(r)},[T]),l.useEffect(()=>{var r;if(m&&((r=y==null?void 0:y.data)!=null&&r.course)){const i=y.data.course;C("title",i.title),C("description",i.description),s(i.image||null)}else m||(v(),s(null),a(null))},[m,y,C,v]),l.useEffect(()=>{localStorage.setItem("courseView",g)},[g]);const ze=r=>{if(r.target.files&&r.target.files[0]){const i=r.target.files[0];a(i),s(URL.createObjectURL(i)),C("image",i)}else a(null),s(null),C("image",void 0)},We=async r=>{try{if(m)await h.mutateAsync({courseId:m,coursePayload:{title:r.title,description:r.description},imageFile:d||void 0});else{if(!d){console.error("Please select an image for the course.");return}await f.mutateAsync({course:{title:r.title,description:r.description},imageFile:d})}v(),a(null),s(null),A(null),K()}catch(i){console.error("Submission error:",i)}},$=r=>{A(r._id),U(r)},J=r=>{B(r),k(!0)},De=async()=>{V&&(await x.mutateAsync(V),k(!1),B(null),K())},Me=()=>{k(!1),B(null)},X=r=>{U(r),_(!0)},Z=(r,i)=>{q(i)},ee=r=>{ke(parseInt(r.target.value,10)),q(0)},F=((te=b==null?void 0:b.data)==null?void 0:te.courses)||[],re=(b==null?void 0:b.total)||0,He=(r,i)=>{i!==null&&Q(i)};return e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:t.container,children:[e.jsx(u,{variant:"h4",component:"h1",sx:t.header,children:m?"Edit Course":"Add New Course"}),(f.isError||h.isError||x.isError)&&e.jsx(w,{severity:"error",sx:t.alert,children:((ie=(se=(oe=f.error)==null?void 0:oe.response)==null?void 0:se.data)==null?void 0:ie.message)||((le=(ne=(ae=h.error)==null?void 0:ae.response)==null?void 0:ne.data)==null?void 0:le.message)||((ue=(ce=(de=x.error)==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:ue.message)||"An unexpected error occurred."}),(f.isSuccess||h.isSuccess||x.isSuccess)&&e.jsx(w,{severity:"success",sx:t.alert,children:((me=f.data)==null?void 0:me.message)||((xe=h.data)==null?void 0:xe.message)||((pe=x.data)==null?void 0:pe.message)||"Operation successful!"}),e.jsx(R,{elevation:3,sx:t.formContainer,children:e.jsxs("form",{onSubmit:Re(We),children:[e.jsx(ge,{name:"title",control:N,render:({field:r})=>{var i;return e.jsx(z,{...r,label:"Course Title",variant:"outlined",fullWidth:!0,sx:t.inputField,error:!!j.title,helperText:(i=j.title)==null?void 0:i.message})}}),e.jsx(ge,{name:"description",control:N,render:({field:r})=>{var i;return e.jsx(z,{...r,label:"Course Description",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,sx:t.inputField,error:!!j.description,helperText:(i=j.description)==null?void 0:i.message})}}),e.jsxs(n,{sx:t.imageUploadContainer,children:[e.jsx("input",{accept:"image/*",style:{display:"none"},id:"course-image-upload",type:"file",onChange:ze}),e.jsx("label",{htmlFor:"course-image-upload",children:e.jsx(W,{variant:"outlined",component:"span",startIcon:e.jsx(Ke,{}),sx:t.uploadButton,children:"Upload Image"})}),o&&e.jsxs(n,{sx:t.imagePreviewBox,children:[e.jsx("img",{src:o,alt:"Course Preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}),e.jsx(p,{onClick:()=>{s(null),a(null),C("image",void 0)},sx:t.removeImageButton,children:e.jsx(Ne,{})})]}),j.image&&e.jsx(u,{color:"error",variant:"body2",sx:{mt:1},children:j.image.message})]}),e.jsx(W,{type:"submit",variant:"contained",color:"primary",sx:t.submitButton,disabled:Y||f.isPending||h.isPending,children:Y||f.isPending||h.isPending?e.jsx(D,{size:24,color:"inherit"}):m?"Update Course":"Create Course"}),m&&e.jsx(W,{variant:"outlined",color:"secondary",onClick:()=>{A(null),v(),s(null),a(null)},sx:t.cancelEditButton,children:"Cancel Edit"})]})}),e.jsxs(n,{sx:{mt:4},children:[e.jsx(u,{variant:"h5",component:"h2",sx:t.subHeader,children:"Existing Courses"}),e.jsxs(n,{sx:t.searchAndSwitchContainer,children:[e.jsx(z,{label:"Search Courses",variant:"outlined",size:"small",value:T,onChange:r=>Be(r.target.value),InputProps:{startAdornment:e.jsx(rr,{position:"start",children:e.jsx(Ye,{})})},sx:t.searchField}),e.jsxs(Je,{value:g,exclusive:!0,onChange:He,"aria-label":"blog view",sx:Xe.viewToggle,children:[e.jsx(he,{value:"table","aria-label":"table view",buttonType:"block",sx:{marginRight:.5},children:e.jsx(Ze,{})}),e.jsx(he,{value:"grid","aria-label":"grid view",buttonType:"block",children:e.jsx(er,{})})]})]}),Te?e.jsx(n,{sx:t.loadingBox,children:e.jsx(D,{})}):Ee?e.jsxs(w,{severity:"error",sx:t.alert,children:["Error loading courses: ",E==null?void 0:E.message]}):F.length===0?e.jsx(w,{severity:"info",sx:t.alert,children:"No courses found."}):e.jsx(e.Fragment,{children:g==="table"?e.jsxs(tr,{component:R,sx:t.tableContainer,children:[e.jsxs(or,{children:[e.jsx(sr,{children:e.jsxs(be,{children:[e.jsx(c,{sx:t.tableHeader,children:"Image"}),e.jsx(c,{sx:t.tableHeader,children:"Title"}),e.jsx(c,{sx:t.tableHeader,children:"Description"}),e.jsx(c,{sx:t.tableHeader,children:"Created By"}),e.jsx(c,{sx:t.tableHeader,children:"Status"}),e.jsx(c,{sx:t.tableHeader,align:"right",children:"Actions"})]})}),e.jsx(ir,{children:F.map(r=>e.jsxs(be,{sx:t.tableRow,children:[e.jsx(c,{children:e.jsx("img",{src:r.image||ve,alt:r.title,style:{width:"50px",height:"50px",objectFit:"cover",borderRadius:"4px",flexShrink:0}})}),e.jsx(c,{sx:t.tableCell,children:r.title}),e.jsx(c,{sx:t.tableCell,children:r.description.length>50?`${r.description.substring(0,50)}...`:r.description}),e.jsx(c,{sx:t.tableCell,children:typeof r.createdBy=="object"&&r.createdBy!==null?r.createdBy.name:"Admin"}),e.jsx(c,{sx:t.tableCell,children:e.jsx(ar,{label:r.isActive?"Active":"Inactive",color:r.isActive?"success":"error",variant:"filled",size:"small"})}),e.jsx(c,{align:"right",sx:t.tableCell,children:e.jsxs(n,{sx:t.tableActions,children:[e.jsx(p,{size:"small",onClick:()=>$(r),"aria-label":"edit course",disabled:!r.isActive,sx:{cursor:r.isActive?"pointer":"not-allowed !important"},children:e.jsx(je,{fontSize:"small"})}),e.jsx(p,{size:"small",onClick:()=>X(r),"aria-label":"view course",children:e.jsx(fe,{fontSize:"small"})}),e.jsx(p,{size:"small",onClick:()=>J(r._id),"aria-label":"delete course",disabled:!r.isActive||x.isPending,sx:{cursor:r.isActive?"pointer":"not-allowed !important"},children:e.jsx(ye,{fontSize:"small"})})]})})]},r._id))})]}),e.jsx(Ce,{rowsPerPageOptions:[5,10,25],component:"div",count:re,rowsPerPage:P,page:I,onPageChange:Z,onRowsPerPageChange:ee})]}):e.jsxs(Ge,{children:[e.jsx(n,{sx:t.courseGrid,children:F.map(r=>e.jsxs(R,{elevation:2,sx:t.courseCard,children:[e.jsx("img",{src:r.image||ve,alt:r.title,style:{width:"100%",height:"180px",objectFit:"cover"}}),e.jsxs(n,{sx:t.courseCardContent,children:[e.jsx(u,{variant:"h6",sx:t.courseCardTitle,children:r.title}),e.jsx(u,{variant:"body2",sx:t.courseCardDescription,children:r.description}),e.jsxs(u,{variant:"body2",color:"text.secondary",children:["Status: ",r.isActive?"Active":"Inactive"]}),e.jsxs(n,{sx:t.courseCardActions,children:[e.jsx(p,{color:"primary",size:"small",onClick:()=>$(r),disabled:!r.isActive,sx:{cursor:r.isActive?"pointer":"not-allowed !important"},children:e.jsx(je,{fontSize:"small"})}),e.jsx(p,{color:"error",size:"small",onClick:()=>J(r._id),disabled:!r.isActive||x.isPending,sx:{cursor:r.isActive?"pointer":"not-allowed !important"},children:e.jsx(ye,{fontSize:"small"})}),e.jsx(p,{color:"success",size:"small",onClick:()=>X(r),children:e.jsx(fe,{fontSize:"small"})})]})]})]},r._id))}),e.jsx(Ce,{rowsPerPageOptions:[5,10,25],component:"div",count:re,rowsPerPage:P,page:I,onPageChange:Z,onRowsPerPageChange:ee,sx:t.paginationContainer})]})})]})]}),e.jsx(mr,{open:we,onClose:()=>_(!1),course:Se,loading:Fe}),e.jsx($e,{open:Ae,onClose:Me,onConfirm:De,title:"Confirm Deletion",description:"Are you sure you want to delete this course? This action cannot be undone.",loading:x.isPending})]})},Br=()=>e.jsx(xr,{});export{Br as default};
